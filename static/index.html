<!DOCTYPE html>
<html>
<body>
    <style>
  body {
    background-color: #1e1e1e;
    color: #ffffff;
    font-family: Arial, sans-serif;
    margin: 20px;
  }

  input, button {
    padding: 8px;
    font-size: 14px;
    margin: 4px 0;
    border-radius: 4px;
    border: none;
  }

  input {
    width: 300px;
  }

  button {
    cursor: pointer;
    background-color: #444;
    color: #fff;
  }

  button:hover {
    background-color: #666;
  }

  ul#chat {
    list-style-type: none;
    padding: 0;
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid #333;
    border-radius: 4px;
    background-color: #2e2e2e;
  }

  ul#chat li {
    padding: 4px 8px;
    margin-bottom: 2px;
    border-radius: 3px;
  }
</style>

  <h2>talkity</h2>
  <input id="msg" type="text" placeholder="Type message...">
  <button onclick="sendMsg()">Send</button>
  <ul id="chat"></ul>

<script>
  let username = prompt("Enter your username:");


  if (!username) username = "Anonymous";

  <script>
  const protocol = window.location.protocol === "https:" ? "wss" : "ws";
  const ws = new WebSocket(`${protocol}://${window.location.host}/ws`);
 </script>
  // Color mapping
  let userColors = {};
  const colors = ["#e6194b", "#3cb44b", "#ffe119", "#4363d8", "#f58231", "#911eb4", "#46f0f0", "#f032e6", "#bcf60c", "#fabebe"];

  function getColor(name) {
      if (userColors[name]) return userColors[name];
      // deterministic color by summing char codes
      let sum = 0;
      for (let i = 0; i < name.length; i++) sum += name.charCodeAt(i);
      let color = colors[sum % colors.length];
      userColors[name] = color;
      return color;
  }
  ws.onmessage = function(event) {
    let li = document.createElement("li");
    let msg = event.data;
    li.textContent = msg;
    let parts = msg.split(":");
    let name = parts[0];
    li.style.color = getColor(name);
    let chat = document.getElementById("chat").appendChild(li);
    chat.scrollTop = chat.scrollHeight; // Auto scroll to bottom
};

// Send message
  function sendMsg() {
      let msg = document.getElementById("msg").value;
      if (!msg) return;
      ws.send(username + ": " + msg);
      document.getElementById("msg").value = "";
  }
</script>
</body>
</html>
